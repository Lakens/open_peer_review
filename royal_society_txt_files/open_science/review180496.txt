Asymptotic convergence in distribution of the area bounded
by prevalence-weighted Kaplan–Meier curves using
empirical process modelling
Aaron Heuser, Minh Huynh and Joshua C. Chang
Article citation details
R. Soc. open sci. 5: 180496.
http://dx.doi.org/10.1098/rsos.180496
Review timeline
Original submission: 26 March 2018 Note: Reports are unedited and appear as
1st revised submission: 23 August 2018 submitted by the referee. The review history
2nd revised submission: 2 October 2018 appears in chronological order.
Final acceptance: 17 October 2018
Review History
label_version_1
RSOS-180496.R0 (Original submission)
label_author_1
Review form: Reviewer 1
Is the manuscript scientifically sound in its present form?
No
Are the interpretations and conclusions justified by the results?
No
Is the language acceptable?
No
Is it clear how to access all supporting data?
No
Reports © 2018 The Reviewers; Decision Letters © 2018 The Reviewers and Editors;
Responses © 2018 The Reviewers, Editors and Authors. Published by the Royal Society under the
terms of the Creative Commons Attribution License http://creativecommons.org/licenses/by/4.0/,
which permits unrestricted use, provided the original author and source are credited
2
Do you have any ethical concerns with this paper?
No
Have you any concerns about statistical analyses in this paper?
No
Recommendation?
label_recommendation_1
Major revision is needed (please make suggestions in comments)
Comments to the Author(s)
label_comment_1
Major Concerns:
The paper proposed a cohort-weighted method to address the issue of potential heterogeneity
within a population in the comparison of time-to-event curves. Sub-populations are used in the
method and the simulations. But the paper doesn't describe how to determine which cohort each
data point (each individual) falls into in a real-world setting, which the reviewer considers
crucial. Because in order to use the proposed method after given a real-world dataset, we have to
first know which cohort each individual comes from. The reviewer would ask the authors to add
this missing piece to make the method complete.
Also, the reviewer is interested in a real-world data example using the proposed method.
Minor Concerns:
The simulation seems to be overly simple. The reviewer would ask the authors to explore more
complicated scenarios, for example, >2 cohorts in one population, and different cohort prevalence
q.
label_author_2
Review form: Reviewer 2 (Jiancang Zhuang)
Is the manuscript scientifically sound in its present form?
Yes
Are the interpretations and conclusions justified by the results?
Yes
Is the language acceptable?
Yes
Is it clear how to access all supporting data?
No
Do you have any ethical concerns with this paper?
No
Have you any concerns about statistical analyses in this paper?
No
3
Recommendation?
label_recommendation_2
Major revision is needed (please make suggestions in comments)
Comments to the Author(s)
label_comment_2
Please see attached file. (See Appendix A)
label_end_comment
Decision letter (RSOS-180496.R0)
09-Aug-2018
Dear Dr Chang,
The editors assigned to your paper ("Empirical process-based large sample properties of the area
bounded by cohort-weighted Kaplan Meier curves") have now received comments from
reviewers. We would like you to revise your paper in accordance with the referee and Associate
Editor suggestions which can be found below (not including confidential reports to the Editor).
Please note this decision does not guarantee eventual acceptance.
Please submit a copy of your revised paper before 01-Sep-2018. Please note that the revision
deadline will expire at 00.00am on this date. If we do not hear from you within this time then it
will be assumed that the paper has been withdrawn. In exceptional circumstances, extensions
may be possible if agreed with the Editorial Office in advance. We do not allow multiple rounds
of revision so we urge you to make every effort to fully address all of the comments at this stage.
If deemed necessary by the Editors, your manuscript will be sent back to one or more of the
original reviewers for assessment. If the original reviewers are not available, we may invite new
reviewers.
To revise your manuscript, log into http://mc.manuscriptcentral.com/rsos and enter your
Author Centre, where you will find your manuscript title listed under "Manuscripts with
Decisions." Under "Actions," click on "Create a Revision." Your manuscript number has been
appended to denote a revision. Revise your manuscript and upload a new version through your
Author Centre.
When submitting your revised manuscript, you must respond to the comments made by the
referees and upload a file "Response to Referees" in "Section 6 - File Upload". Please use this to
document how you have responded to the comments, and the adjustments you have made. In
order to expedite the processing of the revised manuscript, please be as specific as possible in
your response.
In addition to addressing all of the reviewers' and editor's comments please also ensure that your
revised manuscript contains the following sections as appropriate before the reference list:
• Ethics statement (if applicable)
If your study uses humans or animals please include details of the ethical approval received,
including the name of the committee that granted approval. For human studies please also detail
whether informed consent was obtained. For field studies on animals please include details of all
permissions, licences and/or approvals granted to carry out the fieldwork.
4
• Data accessibility
It is a condition of publication that all supporting data are made available either as
supplementary information or preferably in a suitable permanent repository. The data
accessibility section should state where the article's supporting data can be accessed. This section
should also include details, where possible of where to access other relevant research materials
such as statistical tools, protocols, software etc can be accessed. If the data have been deposited in
an external repository this section should list the database, accession number and link to the DOI
for all data from the article that have been made publicly available. Data sets that have been
deposited in an external repository and have a DOI should also be appropriately cited in the
manuscript and included in the reference list.
If you wish to submit your supporting data or code to Dryad (http://datadryad.org/), or modify
your current submission to dryad, please use the following link:
http://datadryad.org/submit?journalID=RSOS&manu=RSOS-180496
• Competing interests
Please declare any financial or non-financial competing interests, or state that you have no
competing interests.
• Authors’ contributions
All submissions, other than those with a single author, must include an Authors’ Contributions
section which individually lists the specific contribution of each author. The list of Authors
should meet all of the following criteria; 1) substantial contributions to conception and design, or
acquisition of data, or analysis and interpretation of data; 2) drafting the article or revising it
critically for important intellectual content; and 3) final approval of the version to be published.
All contributors who do not meet all of these criteria should be included in the
acknowledgements.
We suggest the following format:
AB carried out the molecular lab work, participated in data analysis, carried out sequence
alignments, participated in the design of the study and drafted the manuscript; CD carried out
the statistical analyses; EF collected field data; GH conceived of the study, designed the study,
coordinated the study and helped draft the manuscript. All authors gave final approval for
publication.
• Acknowledgements
Please acknowledge anyone who contributed to the study but did not meet the authorship
criteria.
• Funding statement
Please list the source of funding for each author.
Please note that Royal Society Open Science charge article processing charges for all new
submissions that are accepted for publication. Charges will also apply to papers transferred to
Royal Society Open Science from other Royal Society Publishing journals, as well as papers
submitted as part of our collaboration with the Royal Society of Chemistry
(http://rsos.royalsocietypublishing.org/chemistry). If your manuscript is newly submitted and
subsequently accepted for publication, you will be asked to pay the article processing charge,
unless you request a waiver and this is approved by Royal Society Publishing. You can find out
more about the charges at http://rsos.royalsocietypublishing.org/page/charges. Should you
have any queries, please contact openscience@royalsociety.org.
5
Once again, thank you for submitting your manuscript to Royal Society Open Science and I look
forward to receiving your revision. If you have any questions at all, please do not hesitate to get
in touch.
Kind regards,
Royal Society Open Science Editorial Office
Royal Society Open Science
openscience@royalsociety.org
on behalf of Prof. Mark Chaplain (Subject Editor)
openscience@royalsociety.org
Comments to Author:
Reviewers' Comments to Author:
Reviewer: 1
Comments to the Author(s)
Major Concerns:
The paper proposed a cohort-weighted method to address the issue of potential heterogeneity
within a population in the comparison of time-to-event curves. Sub-populations are used in the
method and the simulations. But the paper doesn't describe how to determine which cohort each
data point (each individual) falls into in a real-world setting, which the reviewer considers
crucial. Because in order to use the proposed method after given a real-world dataset, we have to
first know which cohort each individual comes from. The reviewer would ask the authors to add
this missing piece to make the method complete.
Also, the reviewer is interested in a real-world data example using the proposed method.
Minor Concerns:
The simulation seems to be overly simple. The reviewer would ask the authors to explore more
complicated scenarios, for example, >2 cohorts in one population, and different cohort prevalence
q.
Reviewer: 2
Comments to the Author(s)
Please see attached file.
Author's Response to Decision Letter for (RSOS-180496.R0)
See Appendix B.
6
label_version_2
RSOS-180496.R1 (Revision)
label_author_3
Review form: Reviewer 1
Is the manuscript scientifically sound in its present form?
Yes
Are the interpretations and conclusions justified by the results?
Yes
Is the language acceptable?
Yes
Is it clear how to access all supporting data?
No
Do you have any ethical concerns with this paper?
No
Have you any concerns about statistical analyses in this paper?
No
Recommendation?
label_recommendation_3
Major revision is needed (please make suggestions in comments)
Comments to the Author(s)
label_comment_3
This manuscript proposed a test statistic that was based on a cohort-weighted survival function
estimator. The reviewer would like to see the following revisions:
1) Please add a real world example to demonstrate how the proposed test statistic can be applied.
2) Please add simulations to show that the Type 1 error rate has not been inflated using the
proposed method.
3) The commonly-used method, for example, a log-rank test, can compare the hazard ratios of the
two groups, on top of the P-values. But the proposed method willonly provide P-values.
Therefore we need to beware of the differences in interpretation.
label_author_4
Review form: Reviewer 2 (Jiancang Zhuang)
Is the manuscript scientifically sound in its present form?
Yes
Are the interpretations and conclusions justified by the results?
Yes
Is the language acceptable?
Yes
7
Is it clear how to access all supporting data?
Yes
Do you have any ethical concerns with this paper?
No
Have you any concerns about statistical analyses in this paper?
No
Recommendation?
label_recommendation_4
Accept with minor revision (please list in comments)
Comments to the Author(s)
label_comment_4
The revised manuscript is now much easier to read. The only part that needs improvement is the
quality of Figures 2 and 3.
1. Figure 2. I cannot see the difference clearly. Use logarithm for x-axis?
2. Figure 3. Curves in the legend is not the same as in the plot. The differences in the plots in the
first row are difficult to see.
3. In the last row of Figure 3. The estimation errors are larger for the Cohort-Weighted estimator
than those for the pure KM estimator. Does this mean the Cohort-Weighted estimator is worse
than the KM estimator? Do you have a large-sample example to show the advantages of the CW-
KM estimator?
label_end_comment
Decision letter (RSOS-180496.R1)
20-Sep-2018
Dear Dr Chang:
Manuscript ID RSOS-180496.R1 entitled "Asymptotic convergence in distribution of the area
bounded by prevalence-weighted Kaplan-Meier curves using empirical process modeling" which
you submitted to Royal Society Open Science, has been reviewed. The comments of the
reviewer(s) are included at the bottom of this letter.
Please submit a copy of your revised paper before 13-Oct-2018. Please note that the revision
deadline will expire at 00.00am on this date. If we do not hear from you within this time then it
will be assumed that the paper has been withdrawn. In exceptional circumstances, extensions
may be possible if agreed with the Editorial Office in advance. We do not allow multiple rounds
of revision so we urge you to make every effort to fully address all of the comments at this stage.
If deemed necessary by the Editors, your manuscript will be sent back to one or more of the
original reviewers for assessment. If the original reviewers are not available we may invite new
reviewers.
To revise your manuscript, log into http://mc.manuscriptcentral.com/rsos and enter your
Author Centre, where you will find your manuscript title listed under "Manuscripts with
Decisions." Under "Actions," click on "Create a Revision." Your manuscript number has been
appended to denote a revision. Revise your manuscript and upload a new version through your
Author Centre.
8
When submitting your revised manuscript, you must respond to the comments made by the
referees and upload a file "Response to Referees" in "Section 6 - File Upload". Please use this to
document how you have responded to the comments, and the adjustments you have made. In
order to expedite the processing of the revised manuscript, please be as specific as possible in
your response.
In addition to addressing all of the reviewers' and editor's comments please also ensure that your
revised manuscript contains the following sections before the reference list:
• Ethics statement
If your study uses humans or animals please include details of the ethical approval received,
including the name of the committee that granted approval. For human studies please also detail
whether informed consent was obtained. For field studies on animals please include details of all
permissions, licences and/or approvals granted to carry out the fieldwork.
• Data accessibility
It is a condition of publication that all supporting data are made available either as
supplementary information or preferably in a suitable permanent repository. The data
accessibility section should state where the article's supporting data can be accessed. This section
should also include details, where possible of where to access other relevant research materials
such as statistical tools, protocols, software etc can be accessed. If the data have been deposited in
an external repository this section should list the database, accession number and link to the DOI
for all data from the article that have been made publicly available. Data sets that have been
deposited in an external repository and have a DOI should also be appropriately cited in the
manuscript and included in the reference list.
• Competing interests
Please declare any financial or non-financial competing interests, or state that you have no
competing interests.
• Authors’ contributions
All submissions, other than those with a single author, must include an Authors’ Contributions
section which individually lists the specific contribution of each author. The list of Authors
should meet all of the following criteria; 1) substantial contributions to conception and design, or
acquisition of data, or analysis and interpretation of data; 2) drafting the article or revising it
critically for important intellectual content; and 3) final approval of the version to be published.
All contributors who do not meet all of these criteria should be included in the
acknowledgements.
We suggest the following format:
AB carried out the molecular lab work, participated in data analysis, carried out sequence
alignments, participated in the design of the study and drafted the manuscript; CD carried out
the statistical analyses; EF collected field data; GH conceived of the study, designed the study,
coordinated the study and helped draft the manuscript. All authors gave final approval for
publication.
• Acknowledgements
Please acknowledge anyone who contributed to the study but did not meet the authorship
criteria.
9
• Funding statement
Please list the source of funding for each author.
Please note that Royal Society Open Science charge article processing charges for all new
submissions that are accepted for publication. Charges will also apply to papers transferred to
Royal Society Open Science from other Royal Society Publishing journals, as well as papers
submitted as part of our collaboration with the Royal Society of Chemistry
(http://rsos.royalsocietypublishing.org/chemistry). If your manuscript is newly submitted and
subsequently accepted for publication, you will be asked to pay the article processing charge,
unless you request a waiver and this is approved by Royal Society Publishing. You can find out
more about the charges at http://rsos.royalsocietypublishing.org/page/charges. Should you
have any queries, please contact openscience@royalsociety.org.
Once again, thank you for submitting your manuscript to Royal Society Open Science and I look
forward to receiving your revision. If you have any questions at all, please do not hesitate to get
in touch.
Kind regards,
Royal Society Open Science Editorial Office
Royal Society Open Science
openscience@royalsociety.org
on behalf of Prof. Mark Chaplain (Subject Editor)
openscience@royalsociety.org
Reviewer comments to Author:
Reviewer: 1
Comments to the Author(s)
This manuscript proposed a test statistic that was based on a cohort-weighted survival function
estimator. The reviewer would like to see the following revisions:
1) Please add a real world example to demonstrate how the proposed test statistic can be applied.
2) Please add simulations to show that the Type 1 error rate has not been inflated using the
proposed method.
3) The commonly-used method, for example, a log-rank test, can compare the hazard ratios of the
two groups, on top of the P-values. But the proposed method willonly provide P-values.
Therefore we need to beware of the differences in interpretation.
Reviewer: 2
Comments to the Author(s)
The revised manuscript is now much easier to read. The only part that needs improvement is the
quality of Figures 2 and 3.
1. Figure 2. I cannot see the difference clearly. Use logarithm for x-axis?
2. Figure 3. Curves in the legend is not the same as in the plot. The differences in the plots in the
first row are difficult to see.
3. In the last row of Figure 3. The estimation errors are larger for the Cohort-Weighted estimator
than those for the pure KM estimator. Does this mean the Cohort-Weighted estimator is worse
10
than the KM estimator? Do you have a large-sample example to show the advantages of the CW-
KM estimator?
Author's Response to Decision Letter for (RSOS-180496.R1)
See Appendix C.
label_version_3
RSOS-180496.R2 (Revision)
label_author_5
Review form: Reviewer 1 (Xun Lin)
Is the manuscript scientifically sound in its present form?
Yes
Are the interpretations and conclusions justified by the results?
Yes
Is the language acceptable?
Yes
Is it clear how to access all supporting data?
Yes
Do you have any ethical concerns with this paper?
No
Have you any concerns about statistical analyses in this paper?
No
Recommendation?
label_recommendation_5
Accept as is
Comments to the Author(s)
label_comment_5
Thank the authors for addressing the comments.
label_author_6
Review form: Reviewer 2 (Jiancang Zhuang)
Is the manuscript scientifically sound in its present form?
Yes
Are the interpretations and conclusions justified by the results?
Yes
11
Is the language acceptable?
Yes
Is it clear how to access all supporting data?
Yes
Do you have any ethical concerns with this paper?
No
Have you any concerns about statistical analyses in this paper?
No
Recommendation?
label_recommendation_6
Accept as is
Comments to the Author(s)
label_comment_6
The authors have clarified my questions in the revision. I have no further suggestions except
Line 47. Figure 4 -> Figure 5.
label_end_comment
Decision letter (RSOS-180496.R2)
17-Oct-2018
Dear Dr Chang,
I am pleased to inform you that your manuscript entitled "Asymptotic convergence in
distribution of the area bounded by prevalence-weighted Kaplan-Meier curves using empirical
process modeling" is now accepted for publication in Royal Society Open Science.
You can expect to receive a proof of your article in the near future. Please contact the editorial
office (openscience_proofs@royalsociety.org and openscience@royalsociety.org) to let us know if
you are likely to be away from e-mail contact. Due to rapid publication and an extremely tight
schedule, if comments are not received, your paper may experience a delay in publication.
Royal Society Open Science operates under a continuous publication model
(http://bit.ly/cpFAQ). Your article will be published straight into the next open issue and this
will be the final version of the paper. As such, it can be cited immediately by other researchers.
As the issue version of your paper will be the only version to be published I would advise you to
check your proofs thoroughly as changes cannot be made once the paper is published.
On behalf of the Editors of Royal Society Open Science, we look forward to your continued
contributions to the Journal.
Kind regards,
Royal Society Open Science Editorial Office
Royal Society Open Science
openscience@royalsociety.org
12
on behalf of Prof. Mark Chaplain (Subject Editor)
openscience@royalsociety.org
Associate Editor Comments to Author:
With the exception of a typo spotted by one of the referees, this paper is now ready for
acceptance -- congratulations! Please ensure that you tackle this minor modification during
typesetting.
Reviewer comments to Author:
Reviewer: 1
Comments to the Author(s)
Thank the authors for addressing the comments.
Reviewer: 2
Comments to the Author(s)
The authors have clarified my questions in the revision. I have no further suggestions except
Line 47. Figure 4 -> Figure 5.
Follow Royal Society Publishing on Twitter: @RSocPublishing
Follow Royal Society Publishing on Facebook:
https://www.facebook.com/RoyalSocietyPublishing.FanPage/
Read Royal Society Publishing's blog: https://blogs.royalsociety.org/publishing/
Appendix A
Comments on “Empirical process-based large sample properties of the area bounded by
cohort-weighted Kaplan Meier curves” by A. Heuser, M. Huynh, & J. Chang
The theme of the article seems to be on the comparison between two KM estimators, <U+0001D703>^<U+0001D461> and
<U+0001D446>^<U+0001D461> , for cohort-level samples. I use the word “seems” because the whole article does not keep
on the track of such a comparison. In the abstract, the authors state that this paper derives the
properties of the Kaplan-Meier product-limit estimator when individuals are separated by
cohort. But in Page 5, the authors say that the main results is related to the static defined in
Equation (2.4), which is used to test whether two disjoint sets of population have the same
survival functions. It is not clear that how can you use this static to compare your method and
the original pure KM estimator.
Section 2
1. Line 50·, Page 5. It seems that a portion of the contents is missing here.
Section 3
2. A careful description of the simulation data is necessary. Is not Population 1 too simple?
3. Figure 3. The true survival functions that are used in the simulation should be superposed
4. The analysis on the simulation data should be the numerical experiment to verify the main
results. However, I cannot see in the data analysis, the asymptotic properties of <U+0001D703>^<U+0001D461> and
<U+0001D446>^<U+0001D461> are verified. That is to say, the theoretical variance of the estimators should be
compared to the simulation results.
Appendix A.
This appendix is referred at the beginning of Section 2(a). Thus, all the notations that are not
yet defined should be defined or explained. However, there are many notations in the
appendix used before they are defined.
1. Line 26, Page 10. What is <U+0001D434><U+0001D456> ?
2. Line 60, Page 10. What are <U+0001D707>1,<U+0001D467>,<U+0001D70F><U+0001D467> and <U+0001D70F><U+0001D467> ?
3. Line 18, Page 11. What is <U+0001D44E><U+0001D467> ?
4. Lines 30 to 34, Page 11. What is <U+0001D446>^<U+0001D467>,<U+0001D460>- (<U+0001D45E>^<U+0001D467> )? Which section is “the previous section”?
References
12 to 14. The initial letters of “kaplan” and “meier” should be capitalized.
In summary, this article should be re-organized to focus on its theme in both theory and
simulation verification, and the simulation part should be extended.
Appendix B
Responses to the reviewers
August 22, 2018
We would like to thank the reviews for their careful assessment of our manuscript. We know that
this manuscript is extremely technical and appreciate the feedback in making it more understand-
able. We have made many modifications to our manuscript in the intent that they directly address
the concerns raised by the reviewers. Both reviewers raised a general point about the motivations
for this manuscript. We regret that we had not made the focus of our manuscript more clear.
Here, we will describe our motivations and some changes we made to the manuscript with
the additional hope that it will allay Review 1’s concerns. We had two main intentions in the
writing of this manuscript. First was to document the technical details of the methodology that
was used by the NIH and Social Security Administration (SSA) in identifying medical conditions
where applicants require fast-tracking in the adjudication of disability claims. We had alluded to
this application of the work previously in the discussion but now have added the following text to
the introduction section:
pg 2: These complexities arose in the identification of new disorders to incorporate into
the United States Social Security Administration (SSA)’s Compassionate Allowances
(CAL) initiative. The CAL initiative seeks to identify candidate medical conditions for
fast-tracking in the processing of disability applications. The intent of this initiative
is to prioritize applicants who are most likely to die in the time-course of usual case
processing so that they may receive benefits while still living. At its inception, the CAL
initiative identified conditions based on the counsel of expert opinion [15]. The SSA in
collaboration with the National Institutes of Health (NIH) sought to expand the list of
CAL conditions systematically, using a data-based approach. Using in-part the survival
estimator described in this manuscript, the NIH identified 24 conditions for inclusion
into the list of conditions [15].
The methodology used in CAL is related to that of the work of Pepe and Fleming (cf.
[13,14]), where a class of weighted Kaplan-Meier statistics is introduced. Though these
statistics exhibit the same limitations as in the standard Kaplan-Meier case, it should be
noted that [14] introduces the stratified weighted Kaplan-Meier statistic. The statistic
presented here is a priori quite similar, but instead of a weighting function, includes the
empirical prevalence. In doing so, the weight is no longer independent of the event time
estimate, and thus requires much different methods of proof.
In addition, we provide some more details on how the NIH/SSA used this estimator in the
Discussion:
pg 7: A variant of this method was used in Rasch et al. [15] in order to classify physical
disorders based on severity for the sake of prioritization of processing for disability
1
claims. Since the underlying survival surface is non-stationary, and the fixed observation
windows create progressive censoring, that paper illustrates the utility of this statistical
method. In that manuscript, the cohorts were defined based on binned application entry
times and a heuristic “survival surface” was generated in order to get a single overall
picture of the survivability of a given disorder. The censoring parameters tz varied due
to the finite sampling window and the fact that more-recent cohorts are not observed
for as long a time period as older cohorts, as depicted in Fig 1b. It was also expected
that survival by cohort would vary due to differences in health care administration and
treatment between entry cohorts. The use of the empirical prevalences (q^z ) allowed the
accounting for variability in disability application volume by sufferers of given disorders,
conditional on entry date.
Although the most direct and natural applications of the method that we have pre-
sented here involve discretely-indexed covariates, it is possible to use this method for
continuously-indexed covariates such as time by employing the binning strategy used
in Rasch et al. [15]. This approach is particularly fruitful if the sampling windows are
coarse and there is clear separation between cohorts to maintain statistical indepen-
dence. In this situation, it may be unreasonable to expect to construct a full continuous
surface for survival. Nonetheless, a possible future extension of this method might in-
volve replacing the sum of Eq. 2.1 with an integral and using statistical regularization
tools [4] in order to infer true continuously-indexed surfaces.
From more of a mathematical standpoint, the second intent of this manuscript was to prove the
asymptotic properties of our modification to the Pepe-Fleming weighted survival estimator using
an empirical process model. The classical estimator assumed that the weighting proportions are
known constants. Our estimator <U+03B8>^ assumes that q is estimated from the given sample. We hope
that the derivation of the large sample properties from the framework of empirical processes would
be useful to a reader interested in mathematical statistics.
The question of cohort-identifiability came up in both reviewers’ critiques. In our application
we are assuming that one knows the cohort of the individuals. In the SSA’s dataset, individuals
were identified by their primary physical impairment and the time of application. The cohorts in
this application pertained to year of application for benefits. We make this point more clear in the
definition of <U+03B8>t .
(i)
Pg 3: where Sz,t represents the survival function for individuals of cohort z in population
i, where each individual’s cohort membership is known.
Besides the changes made in direct response to the reviewers, we have made an effort to ensure
that the notation we used is consistent and have made several changes. Notably, we had originally
dropped some superscripts that denoted the size of the empirical process and went instead with
indices representing cohort proportions. We believe that this notation was confusing so we have
made appropriate modifications.
We have also reorganized the manuscript, putting the modeling section into the appendix along
with the rest of the proof so that it can be read more linearly. The appendix is now largely self-
contained, except in a few places where it refers to the main quantities defined in Section 2 of
the text. We have made effort in making the proof more readable and provide more high-level
exposition.
2
Reviewer 2
The theme of the article seems to be on the comparison between two KM estimators, <U+03B8>^t and S^t , for cohort-level samples.
I use the word “seems” because the whole article does not keep on the track of such a comparison. In the abstract, the
authors state that this paper derives the properties of the Kaplan-Meier product-limit estimator when individuals are
separated by cohort. But in Page 5, the authors say that the main results is related to the static defined in Equation
(2.4), which is used to test whether two disjoint sets of population have the same survival functions. It is not clear that
how can you use this static to compare your method and the original pure KM estimator.
We regret that the motivation for our article was lost. The focus is not the comparison of these
estimators as this has been done before the the literature. We provide exposition on this particular
weighted estimator because we prove a property of it – the asymptotics of it’s bounding area. We
have added the following text:
Pg 3: The focus of this manuscript is not the properties of this survival estimator but
rather the asymptotic convergence of its bounding area and the use of such a quantity
for evaluating a null hypothesis.
Section 2 1. Line 50, Page 5. It seems that a portion of the contents is missing here.
We have fixed this error
Section 3 2. A careful description of the simulation data is necessary. Is not Population 1 too simple?
The aim of our simulation is to find a simple example where a family of populations is difficult to
identify on the basis of mean survival time in order to demonstrate the weighted survival estimate
and the statistical power. To make this point clear we have added the text:
Pg 5: Using simulations, we explored the statistical power of the test statistic T^ in a
case where populations are difficult to distinguish based purely on mean survival time.
3. Figure 3. The true survival functions that are used in the simulation should be superposed
We have added traces of the true survival functions which now appears in blue.
4. The analysis on the simulation data should be the numerical experiment to verify the main results. However, I cannot
see in the data analysis, the asymptotic properties of <U+03B8>^t and S^t are verified. That is to say, the theoretical variance of
the estimators should be compared to the simulation results.
The asymptotic properties of the product limit estimator and its weighted variant are well
documented in the literature. Besides referencing the Pepe-Fleming article, we also now cite an
additional source establishing convergence for the unweighted KM estimator:
Pg 3: The asymptotic convergence of the product-limit estimator and weighted variants
is well established [4,15].
The asymptotic variance of the test statistic T^ is under the assumption of the null hypothesis,
being that <U+03B8>(1) = <U+03B8>(2) . In our manuscript we have proven its asymptotic variance in this restricted
setting of a null hypothesis. We think that rather than demonstrating convergence through a
simulation, which is inferior to a proof that we provided, the salient feature of the statistic is in its
power to distinguish populations in the case where <U+03B8>(1) 6= <U+03B8>(2) . Hence, that is why we provided the
comparison demonstrated in Fig. 4.
3
Appendix A. This appendix is referred at the beginning of Section 2(a). Thus, all the notations that are not yet defined
should be defined or explained. However, there are many notations in the appendix used before they are defined.
Thank you for noting this fact. We have gone through and made sure that the appendix is
notationally self-sufficient through a restructuring of the manuscript. We have also worked to make
the proof easier to follow by adding more references to equations along the way.
1. Line 26, Page 10. What is Ai ?
We regret the use of Ai , the meaning of which was to denote a set corresponding to the datapoint
xi . The new notation that we now use is more clear.
Pg 10:
n
v 1 X
Gn h = n (Pn - P) h = v (h(xi ) - Ph) ,
¯ ¯ n i=1 ¯
2. Line 60, Page 10. What are µ1,z,tz and tz ?
µk,z,tz referred to the population size as present in an empirical process for particles in state k
of cohort z at time tz . The time coordinate is relative to the observation window of the cohort and
each cohort may have a different time at which censorship occurs tz , though we allow for individual
members to become censored before this time. Implicit in this notation was that we were starting
with a given number nz particles in a dormant state before t = 0, which we now make explicit in
our new notation. We have explained this notation by including the following text:
Pg 11: let µnj,z,tz
= 0 be the number of the cohort z individuals who are in state j <U+2208> Z4
¯
at time t, so that
X 3
µnj,z,t
z
= nz (1)
j=0
is conserved. Also, we assume that there exists tz < 8 when all particles either become
inactive or censored so that tz is the infimum time where the condition
nz = µn2,z,t
z
+ µn3,z,t
z
<U+2200>t > tz (2)
holds.
3. Line 18, Page 11. What is az ?
The az refer to fixed (known) proportion of cohort z as in the original Pepe-Fleming estimator.
We modify this estimator by replacing az with the sample proportions q^z , which is estimated from
the sample. We have made this fact more clear in the text:
Pg 11: Assume the sample contains a known number nz = az n, az <U+2208> (0, 1), of individ-
uals of cohort z, and let µnj,z,t z
= 0 be the number of the cohort z individuals who are in
state j <U+2208> Z4 at time t,
¯
4
4. Lines 30 to 34, Page 11. What is S^z,s- (q^z )? Which section is “the previous sectio”?
S^z,s- (q^z ) refers to the Kaplan-Meier estimator for cohort z, assuming that nz = q^z n total em-
pirical process “particles” contributed to the computation of the KM estimator. We have modified
the notation, explaining it now in the modeling section:
Pg 11: For the sample of size nz , we denote the z-type cumulative hazard by <U+039B>z,t and
respectively define the z-type cumulative hazard and survival estimates by
Z t nz
nz
dµ2,z,s
<U+039B>^z,t = nz (3)
0 µ1,z,s-
Y 
nz
S^z,t = 1 - d<U+039B>^nz,sz . (4)
s=t
5
Appendix C
Responses to the second-round reviewers
October 2, 2018
The authors thank the reviewers for their helpful suggestions. We have responded to all of the
reviewers’ concerns by making appropriate modifications to our manuscript. As a result of these
changes, we feel that our manuscript is much improved. We also now provide an R implementation
of the overall method, available as a package. Please see below for our itemized responses to the
second round of review.
Reviewer 1
1. Please add a real world example to demonstrate how the proposed test statistic can be applied.
In the updated manuscript, we have used publicly available data within the survival package
for R in order to demonstrate the estimators. In this example, we compared survival between
males and females, using ECOG performance score to organize cohorts. In the course of doing
this example application, we have decided to clean up our R code and make it public as a
package so that others may easily implement this test statistic. Notably, our package contains
some utility functions for arithmetic with piecewise functions in R so we hope that this code
will be useful.
We reference this particular application in section 3(b), titled Evaluating Type-I error in a real
world example. The source code for this example is presented in the appendices. In Figure 5,
we provide the corresponding <U+03B8>^t estimates and in the text we note the value of the statistic,
its asymptotic confidence interval, and its corresponding asymptotic P -value. For reference,
we also computed P -values using the other two methods mentioned in the text. Please refer
to the following text from the paper:
pg 6:
We applied the survival estimator and statistic to NCCTG Lung Cancer data [13]
available within the survival package for R. We compared the survival between
male (n(1) = 136) and female (n(2) = 90) cancer patients, organized by ECOG
performance score (z <U+2208> {0, 1, 2}) as cohort. Using males as population 1 and females
as population 2, we arrived at the test-statistic estimate: T^ = -961, with 95%
asymptotic confidence interval: (-1527, -396), which would support rejection (P ˜
0.0009) of the null hypothesis (<U+03B8>^(1) = <U+03B8>^(2) ) at a = 0.05. For reference, both the
Wilcoxon (P ˜ 0.0012) and log-rank (P ˜ 0.0015) tests referenced in Fig. 4 also
rejected the null hypothesis.
1
2. Please add simulations to show that the Type 1 error rate has not been inflated using the proposed method.
The type-1 error is set to a pre-defined level (we used a = 0.05). We think this question is
asking whether the T^ statistic and its asymptotic variance imply the correct Type-I error rate
– in essence, asking about the validity of the asymptotic normality of the test statistic. To
validate the behavior of the statistic, we resampled the male subpopulation of the lung cancer
data, comparing survival between random sets of males of defined sample sizes. In Figure 6,
we looked at the rejection rate of H0 according to the asymptotic statistics of T^ at a = 0.05.
We note that the rejection rate is slightly elevated (˜ 6%) in n = 40, but by n = 80 the rate
converges to the correct value. In Figure 7, we look at the convergence in distribution for
intermediate sample sizes.
3. The commonly-used method, for example, a log-rank test, can compare the hazard ratios of the two groups, on
top of the P-values. But the proposed method will only provide P-values. Therefore we need to beware of the
differences in interpretation
Thank you for noting this point. We have mentioned it now in the text of the revised
manuscript in the Discussion, as a limitation of the utility of the method.
pg 9: We note that a strong limitation of the presented method lies in its framing in
terms of null hypothesis statistical testing. The T^ statistic only provides a P -value,
as opposed to other tests such as the log-rank test which provide hazard ratios as
well. As a trade-off for statistical power, one is sacrificing interpretability in the
form of effect sizes.
Reviewer 2
1. Figure 2. I cannot see the difference clearly. Use logarithm for x-axis?
Thank you for this suggestion. We have amended this figure to add panels zoomed into the
region where differences are observable, plotted in log scale. We have also changed the values
of q2 that we display so that differences are more noticeable.
2. Figure 3. Curves in the legend is not the same as in the plot. The differences in the plots in the first row are
difficult to see.
We have modified this figure, ensuring that the legend guide for the truth is correctly labeled.
The differences between survival estimates will be subtle. The first row of the figure is intended
to show this fact but also to show that there do in fact exist differences when one reweights
the Kaplan-Meier estimator.
3. In the last row of Figure 3. The estimation errors are larger for the Cohort-Weighted estimator than those for the
pure KM estimator. Does this mean the Cohort-Weighted estimator is worse than the KM estimator? Do you have
a large-sample example to show the advantages of the CW-KM estimator?
Previously, we had allowed the y-axis scale to change between the panels, so that the dif-
ferences between the two estimator errors are highlighted. We think that this scaling makes
it difficult to see the overall behavior of the two estimators – the mutual convergence of the
mean squared error to zero. In our new manuscript, we have set y-axis limits to be consistent
between the panels.
In absolute terms, the performance difference in terms of error at large sample sizes is minimal.
The interesting differences occur mainly in the small-sample regime. In this regime, CW-KM
does better at the tails than KM, at the expense of doing worse for earlier times. In all cases,
2
the variance of CW-KM is lower than that of KM. This phenomenon is a bit like the variance–
bias tradeoff when looking at biased versus unbiased predictors. Please see the discussion in
the updated manuscript:
Pg 9: In the second and third rows of Fig. 3, one sees that this reweighted estimator
has comparable performance to the pure Kaplan-Meier estimator at large sample
sizes. Asymptotically, both estimators converge to the true survival function, with
variance converging to zero. At small sample sizes, there are differences. The
reweighted estimator has reduced variance at the cost of larger bias, in a time-
dependent manner. It also appears to have smaller variance at the cost of larger
error at earlier times. This error at earlier times is mitigated by decreased error
at later times (better reconstruction of tails), however, the estimator variance is
lower at all times. Hence, dependent on costs, for small samples, this reweighted
estimator may be preferable to the pure Kaplan-Meier estimator.
3
Society Open
