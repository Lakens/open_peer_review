A stochastic vision-based model inspired by zebrafish
collective behaviour in heterogeneous environments
Bertrand Collignon, Axel Séguret and José Halloy
Article citation details
R. Soc. open sci. 2: 150473.
http://dx.doi.org/10.1098/rsos.150473
Review timeline
Original submission: 10 September 2015 Note: Reports are unedited and appear as
Revised submission: 27 November 2015 submitted by the referee. The review history
Final acceptance: 2 December 2015 appears in chronological order.
Review History
label_version_1
RSOS-150473.R0 (Original submission)
label_author_1
Review form: Reviewer 1 (Ariana Strandburg-Peshkin)
Is the manuscript scientifically sound in its present form?
Yes
Are the interpretations and conclusions justified by the results?
Yes
Is the language acceptable?
No
Is it clear how to access all supporting data?
Supporting data are not provided.
Do you have any ethical concerns with this paper?
Yes
Have you any concerns about statistical analyses in this paper?
No
Recommendation?
label_recommendation_1
Major revision is needed (please make suggestions in comments)
© 2015 The Authors. Published by the Royal Society under the terms of the Creative Commons
Attribution License http://creativecommons.org/licenses/by/4.0/, which permits unrestricted use,
provided the original author and source are credited
2
Comments to the Author(s)
label_comment_1
Comments are in the attached file (see Appendix A).
label_author_2
Review form: Reviewer 2
Is the manuscript scientifically sound in its present form?
Yes
Are the interpretations and conclusions justified by the results?
Yes
Is the language acceptable?
Yes
Is it clear how to access all supporting data?
No information is given in the manuscript how the authors make their data available.
Do you have any ethical concerns with this paper?
No
Have you any concerns about statistical analyses in this paper?
No
Recommendation?
label_recommendation_2
Accept with minor revision (please list in comments)
Comments to the Author(s)
label_comment_2
This paper reports a study on zebrafish collective behaviour where their movements modelled
using probability density functions based on their visual perception. The experiment and the
simulation work performed seem thoughtful and convincing.
Overall, I find that the paper is interesting and clear. I have only minor suggestions that need to
be addressed. I would look forward to receiving the manuscript in an improved form.
- Main comments:
1) In the current version of the manuscript I could not find out how collectively the fish behave in
the given experimental setup. Their collective behaviour should be characterized. I strongly
suggest presenting their behaviour by providing supplementary videos both of the experimental
data and of the simulations.
2) In the model nothing prevents the fish to collide and to overlap with each other, as mentioned
in the Discussion section by the authors, but it is not clear what stop overlapping of agents and to
remain stuck together? As the modelled fish have a given size, the closer they are to another fish,
so the bigger they appear, thus the more they will move towards each other.
- Notes:
3) The keywords could be chosen more specifically.
4) Eq. 5 and 6.: Eq. 6 has kappa_f_i on the left side, but the right side is independent of i. Should
be kappa_f
5) Eq. 7 and 8.: n is not defined. Should be n_f and in Eq. 9 and 10 it should be n_S.
6) Eq. 9 and 10: in the description A_S_i and A_s_i are used inconsistently. (Capital and lower-
case s)
7) Fig. 3: Please give more details about what is presented on the bottom graphs. Are these
distributions normalized? The axis range of all 3 graphs should be the same.
8) Fig. 5: Please indicate the area or the edge of the area covered by the floating disks.
3
9) Fig. 7B x axis legend: now kappa_0 appears as the unit on the other graphs. Separate it with
just a coma.
10) Page 9. last paragraph: it is not clear how W_F and W_s were calculated. In the second
column from line 37 to 39 the authors wrote that w_F = 1/2 means the influence is divided by 2.
In line 42-44 the w_F = 2 means the influence has to be decreased by a factor of 2. Fig. 15 and its
legend states w_F = 1/2. Please make this clear.
- Minor notes:
11) biased random walked -> biased random walk
12) combinaison -> combination (2x)
13) before Eq. 11 in f(theta) write f with math symbol
14) a average speed -> an average speed
15) the interactions with (what? the boundaries?)
label_end_comment
Decision letter (RSOS-150473)
29-Oct-2015
Dear Dr Collignon,
The editors assigned to your paper ("Zebrafish collective behaviour in heterogeneous
environment modeled by a stochastic model based on visual perception") has now received
comments from reviewers. We would like you to revise your paper in accordance with the
referee and Subject Editor suggestions which can be found below (not including confidential
reports to the Editor). Please note this decision does not guarantee eventual acceptance.
Please submit a copy of your revised paper within three weeks (i.e. by the 21-Nov-2015). If we do
not hear from you within this time then it will be assumed that the paper has been withdrawn. In
exceptional circumstances, extensions may be possible if agreed with the Editorial Office in
advance.We do not allow multiple rounds of revision so we urge you to make every effort to
fully address all of the comments at this stage. If deemed necessary by the Editors, your
manuscript will be sent back to one or more of the original reviewers for assessment. If the
original reviewers are not available we may invite new reviewers.
To revise your manuscript, log into http://mc.manuscriptcentral.com/rsos and enter your
Author Centre, where you will find your manuscript title listed under "Manuscripts with
Decisions." Under "Actions," click on "Create a Revision." Your manuscript number has been
appended to denote a revision. Revise your manuscript and upload a new version through your
Author Centre.
When submitting your revised manuscript, you must respond to the comments made by the
referees and upload a file "Response to Referees" in "Section 6 - File Upload". Please use this to
document how you have responded to the comments, and the adjustments you have made. In
order to expedite the processing of the revised manuscript, please be as specific as possible in
your response.
In addition to addressing all of the reviewers' and editor's comments please also ensure that your
revised manuscript contains the following sections as appropriate before the reference list:
• Ethics statement (if applicable)
If your study uses humans or animals please include details of the ethical approval received,
including the name of the committee that granted approval. For human studies please also detail
whether informed consent was obtained. For field studies on animals please include details of all
permissions, licences and/or approvals granted to carry out the fieldwork.
4
• Data accessibility
It is a condition of publication that all supporting data are made available either as
supplementary information or preferably in a suitable permanent repository. The data
accessibility section should state where the article's supporting data can be accessed. This section
should also include details, where possible of where to access other relevant research materials
such as statistical tools, protocols, software etc can be accessed. If the data has been deposited in
an external repository this section should list the database, accession number and link to the DOI
for all data from the article that has been made publicly available. Data sets that have been
deposited in an external repository and have a DOI should also be appropriately cited in the
manuscript and included in the reference list.
If you wish to submit your supporting data or code to Dryad (http://datadryad.org/), or modify
your current submission to dryad, please use the following link:
http://datadryad.org/submit?journalID=RSOS&manu=RSOS-150473
• Competing interests
Please declare any financial or non-financial competing interests, or state that you have no
competing interests.
• Authors’ contributions
All submissions, other than those with a single author, must include an Authors’ Contributions
section which individually lists the specific contribution of each author. The list of Authors
should meet all of the following criteria; 1) substantial contributions to conception and design, or
acquisition of data, or analysis and interpretation of data; 2) drafting the article or revising it
critically for important intellectual content; and 3) final approval of the version to be published.
All contributors who do not meet all of these criteria should be included in the
acknowledgements.
We suggest the following format:
AB carried out the molecular lab work, participated in data analysis, carried out sequence
alignments, participated in the design of the study and drafted the manuscript; CD carried out
the statistical analyses; EF collected field data; GH conceived of the study, designed the study,
coordinated the study and helped draft the manuscript. All authors gave final approval for
publication.
• Acknowledgements
Please acknowledge anyone who contributed to the study but did not meet the authorship
criteria.
• Funding statement
Please list the source of funding for each author.
Once again, thank you for submitting your manuscript to Royal Society Open Science and I look
forward to receiving your revision. If you have any questions at all, please do not hesitate to get
in touch.
Yours sincerely,
Emilie Aime
Senior Publishing Editor, Royal Society Open Science
on behalf of Kevin Padian
Subject Editor, Royal Society Open Science
openscience@royalsociety.org
5
Author's Response to Decision Letter for (RSOS-150473)
See Appendix B.
Appendix A
Review of Collington, Séguret, and Halloy, “Zebrafish collective behaviour 
in heterogeneous environment modeled by a stochastic model based on 
visual perception” 
Ariana Strandburg-­-Peshkin 
Department of Ecology and Evolutionary Biology, Princeton University 
25 September 2015 
In this study, the authors present a new framework for modeling collective behavior 
in fish schools based on visual perception of stimuli in the environment combined 
with probabilistic decision-­-making. In the model, fish perceive objects around them 
(including other fish as well as stationary disks) and interact with them based on 
the solid angle subtended by the objects in their visual field. Their decision-­-making 
algorithm is then represented by a probability distribution of choosing to move in 
each direction. Each object is assumed to generate a von Mises distributed “peak” in 
this probability distribution, with the widths and heights of these peaks for different 
types of stimuli fitted based on experimental data. The model is built up from a 
single fish swimming in an empty tank, to 10 fish swimming in a tank with two 
floating disk objects. The authors show that the model can accurately capture the 
empirical distribution of space use in all of these contexts, and that it can capture 
the distribution of inter-­-individual distances in homogeneous environments but not 
as well in heterogeneous environments. 
Overall, the study represents an important step forward in terms of modeling 
collective movement behavior. The emphasis on visual perception, and the use of a 
probabilistic decision-­-making algorithm that sums probability distributions, rather 
than assuming that movement is determined by superposition of direction vectors, 
are both key advances. Therefore, I think that this article could be suitable for 
publication provided that the authors can address the revisions suggested below. 
Overall comments: 
1. The comparison of empirical data with model predictions is a nice feature of
the study. However, the extent to which the model provides predictive power
is unclear, since the authors have in all cases used the same data to fit the
model parameters as to validate these predictions. For example, the authors
use the observed distributions of space use and inter-­-individual distributions
to fit the model parameters. They then compare the model predictions (using
the fitted parameters) to the distributions of space use and inter-­-individual
distance, and show that in general they agree. While showing that reasonable
agreement can be achieved does lend some credibility to the model (since
typically the model is predicting distributions based on modifying only a
couple of parameters), it would be far stronger if the model predictions for a
feature not used in fitting were compared with empirical data. For example,
the authors could try comparing empirical data to model predictions for
some other observable, such as the distribution of polarization, elongation, or 
rotation of the group (and I’m sure there are other possibilities as well). It 
seems that the authors may already have the data to perform this 
comparison, and doing so would provide a much more robust test of the 
model. And, if the predictions disagree with observations, this could suggest 
some elements of the model that may be missing. 
If such a comparison is not possible, at the least I would suggest using a 
cross-­-validation method, for example using half of the data to fit the model 
parameters and the other half to compare model predictions with empirical 
observations. 
2. The clarity of the paper would benefit from some reorganization of figures. In
my opinion, there are too many figures in the main text, some of which could
be moved to the supplement (especially those showing least squares
minimization, which are quite hard to read anyway). For example, Figures 6,
7B, 8, 10, 14, and 15 could all be moved to the supplement. Figures 11 and 13
could be combined, and Figures 9 and 16 could also be combined.
3. Overall, there are quite a few grammatical errors in the text (many of which
have to do with verb tense or singular/plural issues), making it somewhat
hard to read. While I have noted a few of these below in the line edits, there
were too many for me to mark each one individually. The authors should go
through the paper carefully to correct these (or, even better, get someone
who was not involved in writing the paper to go through it with a fresh set of
eyes). Doing so will improve the readability of the study, hopefully giving it
the impact it deserves.
4. It would be useful to include a table containing the parameters used in the
model, an explanation of each, and their fitted values.
5. In the model, the authors add the PDFs for each feature in the model,
including the focal fish’s own turning angle distribution (which gives it some
directional persistence). I would have thought it would make more sense to
multiply the focal fish’s turning angle distribution by the sum of the other
distributions, because effectively the fish is choosing which direction to go
based on the features, but overall within the constraints of its own turning
angle distribution. This is not necessarily a fault, but I would be interested to
know why the authors chose the additive structure rather than a
multiplicative structure.
6. I found the discussion of consensus vs. choice confusing. It was unclear to me
whether this discussion was referring to simulation results from agent-­-based
models of collective motion (Couzin et al. 2005, Effective leadership and
decision-­-making in animal groups on the move), which find that groups tend
to compromise by moving in the average preferred direction of individuals
within the group when the angle between these directions is small, but 
choose one or the other when the angle is large. If so, the terminology should 
be changed in order to be consistent with the terminology employed in that 
paper, and the paper should be cited – although in this case it should also be 
noted that the model in the paper actually did use vector superposition, and 
that the compromise vs. choose result was an emergent property of the 
group. (See also Biro et al. 2006 From compromise to leadership in pigeon 
homing and Strandburg-­-Peshkin et al. 2015 Shared decision-­-making drives 
collective movement in wild baboons for empirical studies on this issue.) If 
not, it should be more clearly explained why this feature of the model is 
highlighted, and in this case I recommend using an entirely different 
terminology from Couzin et al. 2005 to avoid confusion. 
7. Since the movement of fish is assumed to occur in two-­-dimensions in the
model, what is the purpose of using the three-­-dimensional solid angle in
computing the apparent size of objects rather than its two-­-dimensional
counterpart?
8. The authors should indicate somewhere that they received the necessary
approval for experimental work with fish.
Line edits (note that the page and line numbers I use here refer to those used by 
label_version_2
RSOS, not those of the authors – these numbers are off by one page from one 
another) 
1. Title: The phrase “in heterogeneous environment” is not grammatically
correct – it could be changed to either “in a heterogeneous environment” or
“in heterogeneous environments”. Personally, I would change the title
anyway to the more active form: “A stochastic model based on visual
perception describes zebrafish collective behavior in heterogeneous
environments”
2. Page 2 Line 48: Recent works based on visual perception should also cite
Rosenthal et al. 2015. This reference also supports the general idea encoded
in the model that objects occupying a larger solid angle have more influence
on the behavior of the fish (though the context is quite different).
3. Figure 1 and Page 3, Line 28: “biological incoherence” is a confusing phrase.
Suggest rephrasing as “biologically unrealistic” or something similar. In
addition, the evidence suggesting that such vector summation is unrealistic
comes from a non-­-social context (zebrafish larvae orienting toward light) – is
there any empirical evidence for or against this idea in a social context?
4. Page 4 Line 4: “We measured their probability of presence [add: in each
location] in the experimental tank…”
5. Page 4, Equation 3: Should the top portion be written as <U+03B8> – <U+03B8>0, where <U+03B8>0 is
the current direction of the fish? In addition, it seems that in the model as
presented, the current direction of the fish no longer plays a role when it is
close to the wall. This would mean that, in the absence of other stimuli, at any
moment in time the fish would have equal probability of moving in its 
current direction along the wall or moving in the opposite direction along the 
wall. Is this correct? If so, it seems strange that the fish would no longer have 
directional persistence when close to a wall. 
6. Figure 2C: Blind zone should also be included in this panel.
7. Page 5, Line 42: “the model computes such a distribution for each stimulus”
rather than “the model draws such distribution for each stimulus” (draws is
confusing here)
8. Page 5, Line 47: should read “the PDF computed for all perceived fish is given
by … with ATf equal to the sum of the solid angles Afi captured by each fish i.
9. Page 6, Line 48: should read “cumulative distribution function” rather than
“cumulated distribution function” (other instances of this phrase in the text
should also be changed)
10. Figure 7: Axis label in panel B should read “index of dispersion”
11. Page 9, Line 41: should read “(20 cm in diameter)”?
12. Page 9, Line 43: “(the ponderation of the influence of the spots)” should be
changed to “(the weight of influence of the spots)”
13. Page 9, Line 43: Why is it assumed that this is equal to 20?
14. Page 11, Line 51: “spatial repartition of the group” should be changed to
“individual space usage when in a group did not differ substantially from
space usage when alone” (note that also the word “significantly” should not
be used unless referring to significance in the statistical sense)
15. Page 12, Line 41-­-44: The sentence beginning “Current modeling tends…” is
unclear and should be rephrased.
16. Page 12, Line 46-­-50: The sentence beginning “This stochastic model…” is
unclear and should be rephrased.
17. Page 12, Line 55: Change to “Indeed, with this approach of summing PDFs…”
18. Page 13, Line 16: Change “hypothesis” to “assumption”
19. Page 13, Line 17: change to “the interactions with environmental features
cannot be neglected…”
20. Page 13, Line 38: “Therefore, these results indicate…” I don’t see how this
point follows from the previous statement.
21. Page 13, Line 1: “in order to focus on the directional decision-­-making
mechanism” -­- Add the word “directional” to differentiate it from decision-­-
making about speed (which should also count as decision-­-making).
22. Page 14, 30: “Since our tracking system did not resolve collision with
accuracy…” I don’t quite understand what you mean here. Is it that the
tracking software could not differentiate which fish was which after
occlusions?
Appendix B
Reviewers’ comments and Authors’ responses
Reviewer: 1
Main comments
Comment #1: The comparison of empirical data with model predictions is
a nice feature of the study. However, the extent to which the model provides
predictive power is unclear, since the authors have in all cases used the same
data to fit the model parameters as to validate these predictions. For exam-
ple, the authors use the observed distributions of space use and inter-individual
distributions to fit the model parameters. They then compare the model predic-
tions (using the fitted parameters) to the distributions of space use and inter-
individual distance, and show that in general they agree. While showing that
reasonable agreement can be achieved does lend some credibility to the model
(since typically the model is predicting distributions based on modifying only
a couple of parameters), it would be far stronger if the model predictions for a
feature not used in fitting were compared with empirical data. For example, the
authors could try comparing empirical data to model predictions for some other
observable, such as the distribution of polarization, elongation, or rotation of
the group (and I’m sure there are other possibilities as well). It seems that the
authors may already have the data to perform this comparison, and doing so
would provide a much more robust test of the model. And, if the predictions
disagree with observations, this could suggest some elements of the model that
may be missing. If such a comparison is not possible, at the least I would sug-
gest using a cross-validation method, for example using half of the data to fit
the model parameters and the other half to compare model predictions with
empirical observations.
Response: Our goal is to highlight that the new approach (perception of solid
angles, stochastic decision making for the direction) developed in this paper is
able to produce collective motion of the simulated agents. Rather than per-
fectly describe zebrafish movement, our intention is to derive the model and
its parameter values from real biological data. For this reason, we observed
individual and collective motion of zebrafish to fit the main parameters of the
model. By doing so, we expect our model to reflect biological mechanisms that
take place in real fish schools. We revised the title of the manuscript to better
reflect our intention : ”A stochastic vision based model inspired by the collective
behaviour of zebrafish in heterogeneous environments”. We agree that further
works should focus on the agreement of the predicted trajectories of agents in
groups with trajectories of real fish during collective motion. However, since a
technology that allows a reliable tracking of the individual with their correct
ID was not available at the time of our experiments, we do not have access
to these individual trajectories. Concerning the cross-validation method, due
to the large number of data gathered during each experiment (54000 and 3600
positions for each fish tested individually in the homogeneous or heterogeneous
environment; 3600 positions for each fish tested in group in the homogeneous or
heterogeneous environment), fitting the parameter values on the half of it would
not change their values significantly. Again, our aim was to derived parameters
values from biological data rather than specifically predict the behaviour of ze-
brafish in this first version of the model.
Comment #2: The clarity of the paper would benefit from some reorgani-
zation of figures. In my opinion, there are too many figures in the main text,
some of which could be moved to the supplement (especially those showing least
squares minimization, which are quite hard to read anyway). For example, Fig-
ures 6, 7B, 8, 10, 14, and 15 could all be moved to the supplement. Figures 11
and 13 could be combined, and Figures 9 and 16 could also be combined.
Response: All mentioned figures are now presented in the supplement. We
also combined the figure showing the inter-individual distances between the fish
swimming in homogeneous or heterogeneous environment.
Comment #3: Overall, there are quite a few grammatical errors in the text
(many of which have to do with verb tense or singular/plural issues), making it
somewhat hard to read. While I have noted a few of these below in the line edits,
there were too many for me to mark each one individually. The authors should
go through the paper carefully to correct these (or, even better, get someone
who was not involved in writing the paper to go through it with a fresh set of
eyes). Doing so will improve the readability of the study, hopefully giving it the
impact it deserves.
Response: We went through the manuscript carefully and hope that the changes
that we have made improve its readability.
Comment #4: It would be useful to include a table containing the parameters
used in the model, an explanation of each, and their fitted values.
Response: We added a recap table at the end of the section describing our
model with the parameters, their values and a short description.
Comment #5: In the model, the authors add the PDFs for each feature in the
model, including the focal fish’s own turning angle distribution (which gives it
some directional persistence). I would have thought it would make more sense
to multiply the focal fish’s turning angle distribution by the sum of the other
distributions, because effectively the fish is choosing which direction to go based
on the features, but overall within the constraints of its own turning angle dis-
tribution. This is not necessarily a fault, but I would be interested to know why
the authors chose the additive structure rather than a multiplicative structure.
Response: The multiplication of the PDFs gives a stronger weight to the focal
fish and weaken the influence of the perceived stimuli. To compare both meth-
ods, we plotted on Fig. 1 the normalized addition and multiplication of the
different PDFs with similar parameter values for the weight of the congeners
and spots. While this problem could be addressed with large parameters val-
ues, we choose to use the additive method that directly include an effect of the
stimuli. In addition, the weighted sum of the PDFs is more easily normalised
with the additive method than with the multiplicative method.
Figure 1:
Comment #6: I found the discussion of consensus vs. choice confusing. It
was unclear to me whether this discussion was referring to simulation results
from agent-based models of collective motion (Couzin et al. 2005, Effective
leadership and decision-making in animal groups on the move), which find that
groups tend to compromise by moving in the average preferred direction of indi-
viduals within the group when the angle between these directions is small, but
choose one or the other when the angle is large. If so, the terminology should
be changed in order to be consistent with the terminology employed in that
paper, and the paper should be cited - although in this case it should also be
noted that the model in the paper actually did use vector superposition, and
that the compromise vs. choose result was an emergent property of the group.
(See also Biro et al. 2006 From compromise to leadership in pigeon homing
and Strandburg-Peshkin et al. 2015 Shared decision-making drives collective
movement in wild baboons for empirical studies on this issue.) If not, it should
be more clearly explained why this feature of the model is highlighted, and in
this case I recommend using an entirely different terminology from Couzin et
al. 2005 to avoid confusion.
Response: Here, we wanted to highlight that the transition appears at the in-
dividual level. ”Consensus” as been replaced by ”Compromise” since it is more
suited for individual decision-making. In addition, all elements of discussion
dealing with consensus vs choice have been moved to the Discussion section to
form an new paragraph : The fish can potentially move in any direction but
it will favour directions associated with a perceived stimuli (congeners for ex-
ample). This is made possible by the representation of the perception field of
the fish and its translation into the normalised sum of the probability distri-
bution functions associated to each perceived stumulus. With this approach of
PDFs’ summation, we can potentially include all kinds of stimuli (congeners,
environment, food...) that are perceived by the fish and account for a choice or
a compromise between potentially antagonist stimuli. As shown in the model
section, two stimuli distant from each other will generate two distinct peaks in
the PDF, leading to a choice of the fish to orient preferentially towards one of
the stimuli. Such choice between two concurrent stimuli has been evidenced in
zebrafish larvae that orient towards one of two light source rather than swim-
ming towards their bisector. On the contrary, when the stimuli get closer from
each other, the two peaks of probability merge into a unique one pointing between
both stimuli. In this case, the fish has a higher probability to orient between the
stimuli rather than choosing one of them. Thus, the propose algorithm is able
to spontaneously transit from choice to compromise and vice versa according to
the spatial distribution of the stimuli.
Comment #7: Since the movement of fish is assumed to occur in two-dimensions
in the model, what is the purpose of using the three-dimensional solid angle in
computing the apparent size of objects rather than its two-dimensional coun-
terpart?
Response: Aside from being more close to the biological reality, the perception
of 3D stimuli by the solid angle that they capture allows the distinction of object
that would have been seen as identical by their planar angle. We added a new
figure (figure 1) to highlight this point.
Comment #8: The authors should indicate somewhere that they received the
necessary approval for experimental work with fish.
Response: We added an Ethics Statement section in the manuscript to indicate
that our work was performed with the approval of the local Ethical Committee.
Short comments
Comment #1: Title: The phrase ”in heterogeneous environment” is not gram-
matically correct - it could be changed to either ”in a heterogeneous environ-
ment” or ”in heterogeneous environments”. Personally, I would change the title
anyway to the more active form: ”A stochastic model based on visual percep-
tion describes zebrafish collective behavior in heterogeneous environments”
Response: As previously said, we revised the title of the manuscript.
Comment #2: Page 2 Line 48: Recent works based on visual perception should
also cite Rosenthal et al. 2015. This reference also supports the general idea
encoded in the model that objects occupying a larger solid angle have more
influence on the behavior of the fish (though the context is quite different).
Response: This reference has been added in the manuscript.
Comment #3: Figure 1 and Page 3, Line 28: ”biological incoherence” is a
confusing phrase. Suggest rephrasing as ”biologically unrealistic” or something
similar. In addition, the evidence suggesting that such vector summation is
unrealistic comes from a non-social context (zebrafish larvae orienting toward
light) - is there any empirical evidence for or against this idea in a social con-
text?
Response: We deleted the ”incoherence” and kept only the ”Potential biolog-
ically problematic situations”. Regarding the stochastic process, most studies
on fish have focused on schools formation with very aligned individuals, making
it difficult to distinguish between summation or stochastic processes since both
can lead to alignement in cohesive groups (see figure 4). However, the main
point of presenting these situations is to highlight that the metric, topologic or
even visual model possess limitations that result in unrealistic behaviour of the
focal agent.
Comment #4: Page 4 Line 4: ”We measured their probability of presence
[add: in each location] in the experimental tank...”
Response: We have corrected this phrase.
Comment #5: Page 4, Equation 3: Should the top portion be written as <U+03B8>-<U+03B8>0 ,
where <U+03B8>0 is the current direction of the fish? In addition, it seems that in the
model as presented, the current direction of the fish no longer plays a role when
it is close to the wall. This would mean that, in the absence of other stimuli,
at any moment in time the fish would have equal probability of moving in its
current direction along the wall or moving in the opposite direction along the
wall. Is this correct? If so, it seems strange that the fish would no longer have
directional persistence when close to a wall.
Response: The top portion could be written <U+03B8> - <U+03B8>0 . However, the perception
field of the fish is centred on its direction so <U+03B8>0 = 0. Regarding the influence of
the walls, we assumed that as soon as a fish perceives a wall, it starts a wall-
following behaviour along this walls. Along a given wall, a fish has a probability
to chose one of two direction as long as both potential directions are included
in its perception field (i.e. are not in the blind angle of the fish). If only one
direction is included in the perception field, the PDF for the wall-following is
only computed according to this direction. Finally, the persistence in given by
the direction of the wall and not anymore by the direction of the fish to reflects
thygmotactism.
Comment #6: Figure 2C: Blind zone should also be included in this panel.
Response: The red zone represents a sphere that is centred on the focal fish
to illustrate the solid angle captured by a perceived fish. As it is spherical, the
blind zone is hidden behind it. To clarify this, we add the caption ”spherical
perception field” on the panel.
Comment #7: Page 5, Line 42: ”the model computes such a distribution for
each stimulus” rather than ”the model draws such distribution for each stimu-
lus” (draws is confusing here)
Response: We have corrected this phrase.
Comment #8: Page 5, Line 47: should read ”the PDF computed for all per-
ceived fish is given by ... with ATf equal to the sum of the solid angles Afi
captured by each fish i.
Response: We have corrected this phrase.
Comment #9: Page 6, Line 48: should read ”cumulative distribution func-
tion” rather than ”cumulated distribution function” (other instances of this
phrase in the text should also be changed)
Response: We have corrected this phrase.
Comment #10: Figure 7: Axis label in panel B should read ”index of disper-
sion”
Response: We have corrected the label.
Comment #11: Page 9, Line 41: should read ”(20 cm in diameter)”
Response: We have corrected this phrase.
Comment #12: Page 9, Line 43: ”the ponderation of the influence of the
spots” should be changed to ”the weight of influence of the spots”
Response: We have corrected this phrase.
Comment #13: Page 9, Line 43: Why is it assumed that this is equal to 20?
Response: The value of 20 was found by fitting for the value of <U+03BA>w , the con-
centration parameter of the von Mises distribution associated with the walls. In
order to diminish the complexity of the fitting for the next steps (interactions
with fish and with spots), we assume that <U+03BA>F and <U+03BA>S are equal to <U+03BA>W . By
doing so, we reduce the parameters’ space to two parameters and diminish the
number of simulations to explore the parameters’ space.
Comment #14: Page 11, Line 51: ”spatial repartition of the group” should be
changed to ”individual space usage when in a group did not differ substantially
from space usage when alone” (note that also the word ”significantly” should
not be used unless referring to significance in the statistical sense)
Response: We have corrected this phrase.
Comment #15: Page 12, Line 41-44: The sentence beginning ”Current mod-
eling tends...” is unclear and should be rephrased.
Response: We have deleted this sentence and rephrase the beginning of this
paragraph since all information and citations where already present in the in-
troduction.
Comment #16: Page 12, Line 46-50: The sentence beginning ”This stochastic
model...” is unclear and should be rephrased.
Response: We have modified the whole paragraph to clarify the discussion.
This sentence has been deleted.
Comment #17: Page 12, Line 55: Change to ”Indeed, with this approach of
summing PDFs...”
Response: We have corrected this phrase.
Comment #18: Page 13, Line 16: Change ”hypothesis” to ”assumption”
Response: We have corrected this phrase.
Comment #19: Page 13, Line 17: change to ”the interactions with environ-
mental features cannot be neglected...”
Response: We have corrected this phrase.
Comment #20: Page 13, Line 38: ”Therefore, these results indicate...” I don’t
see how this point follows from the previous statement.
Response: We replaced the sentence ”These results indicate that the approach
developed in this study can successfully describe the individual and the collec-
tive motions of fish but that further versions should include additional biological
variable that can be species dependent like a preferred distance.” by the shorter
one ”These results indicate that further versions of the model should include
additional biological variables that can be species dependent like a preferred dis-
tance.”
Comment #21: Page 13, Line 1: ”in order to focus on the directional decision-
making mechanism” - Add the word ”directional” to differentiate it from decision-
making about speed (which should also count as decision-making).
Response: We have corrected this phrase.
Comment #22: Page 14, 30: ”Since our tracking system did not resolve colli-
sion with accuracy...” I don’t quite understand what you mean here. Is it that
the tracking software could not differentiate which fish was which after occlu-
sions?
Response: We rephrase this sentence to clarify it: Since our tracking system
could switch the identity of two fish after occlusions (i.e. superposition of two
indistinguishable individuals), we did not calculate individual measures for data
obtained with groups of fish but characterised the aggregation level of the group.
Reviewer: 2
Main comments
Comment #1: In the current version of the manuscript I could not find out
how collectively the fish behave in the given experimental setup. Their col-
lective behaviour should be characterized. I strongly suggest presenting their
behaviour by providing supplementary videos both of the experimental data and
of the simulations.
Response: We provide different videos in the supplementary of the article : 1
video of the positions of 10 zebrafish in a homogeneous environment, 1 video of
the positions of 10 zebrafish in a heterogeneous environment, 1 video of the po-
sitions of 1 simulated fish in homogeneous environment, 1 video of the positions
of 10 simulated fish in homogeneous environment and 1 video of the positions
of 10 simulated fish in heterogeneous environment.
Comment #2: In the model nothing prevents the fish to collide and to overlap
with each other, as mentioned in the Discussion section by the authors, but it
is not clear what stop overlapping of agents and to remain stuck together? As
the modelled fish have a given size, the closer they are to another fish, so the
bigger they appear, thus the more they will move towards each other.
Response: As mentioned by the reviewer, the agents can overlap due to the
absence of repulsion distance or collision avoidance. However, as soon as a focal
fish crosses the path of another fish, this later one is not perceived anymore if it
is not included in the perception field of the focal fish (i.e. if the other fish in be-
hind the focal fish). Therefore, the focal fish will not react to this fish anymore.
In addition, the time step that we choose (<U+2206>t = 1/3s to approximate the beat
tail frequency of zebrafish) avoids the agents from being stuck together since
they will always move for a minimal distance equal to a speed value randomly
chosen in the experimental distribution divided by this time step. However, it
is true that this phenomenon could appear with very small <U+2206>t values. This is
a supplementary argument to implement a repulsion zone in further versions of
the model.
Short comments
Comment #1: The keywords could be chosen more specifically.
Response: We replaced ”Collective behaviour” by ”Collective motion”, deleted
”Modeling” and added ”Perception” and ”Vision”.
Comment #2: Eq. 5 and 6.: Eq. 6 has kappa-f-i on the left side, but the right
side is independent of i. Should be kappa-f
Response: We have corrected these equations.
Comment #3: Eq. 7 and 8.: n is not defined. Should be n-f and in Eq. 9 and
10 it should be n-S.
Response: We have corrected these equations.
Comment #4: Eq. 9 and 10: in the description A-S-i and A-s-i are used in-
consistently. (Capital and lower-case s)
Response: We have corrected these equations.
Comment #5: Fig. 3: Please give more details about what is presented on
the bottom graphs. Are these distributions normalized? The axis range of all 3
graphs should be the same.
Response: We gave more detail about the distribution fF (<U+03B8>) that correspond
to the normalized sum of the PDF computed for each perceived fish. The axis
have been standardised.
Comment #6: Fig. 5: Please indicate the area or the edge of the area covered
by the floating disks.
Response: We have added two small circles to indicate the positions of the
floating disks.
Comment #7: Fig. 7B x axis legend: now kappa-0 appears as the unit on the
other graphs. Separate it with just a coma.
Response: We have corrected this label.
Comment #8: Page 9. last paragraph: it is not clear how W-F and W-s were
calculated. In the second column from line 37 to 39 the authors wrote that w-F
= 1/2 means the influence is divided by 2. In line 42-44 the w-F = 2 means the
influence has to be decreased by a factor of 2. Fig. 15 and its legend states w-F
= 1/2. Please make this clear.
Response: The correct values are wF = 12 and wS = 19 . We have corrected the
values in the text.
Comment #9: biased random walked <U+2192>biased random walk
Response: We have corrected this phrase.
Comment #10: combinaison <U+2192>combination (2x)
Response: We have corrected this phrase.
Comment #11: before Eq. 11 in f(theta) write f with math symbol
Response: We have corrected this phrase.
Comment #12: a average speed <U+2192>an average speed
Response: We have corrected this phrase.
Comment #13: the interactions with (what? the boundaries?)
Response: We have corrected this phrase.
Society Open
